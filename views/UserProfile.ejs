<%- include('./includes/head.ejs',{doc_title:'Profile',styles:'/styles/profile.css'}) %>

    <body>
        <%- include('./includes/header.ejs') %>

            <div class="container d-flex justify-content-center align-items-center">

                <div class="card">

                    <div class="upper">

                        <img src="https://i.imgur.com/Qtrsrk5.jpg" class="img-fluid">

                    </div>

                    <div class="user text-center">

                        <div class="profile">

                            <img src="/assets/user_profile_img.jpeg" class="rounded-circle" width="80">

                        </div>

                    </div>


                    <div class="mt-5 text-center">

                        <h4 class="mb-0">@<%= user.username %></h4>
                        <span class="text-muted d-block mb-2">Email: <%= user.email %></span>

                        <div class="d-flex justify-content-around align-items-center mt-4 px-4">

                            <div class="stats">
                                <h6 class="mb-0">My Postings</h6>
                                <span><%= listings.length %></span>

                            </div>


                            <div class="stats">
                                <h6 class="mb-0">My Reviews</h6>
                                <span><%= reviews.length %></span>

                            </div>

                        </div>

                        

                    </div>

                </div>

            </div>


























            <div class="activity-container">
                <h1>Your Activity</h1>
                <div class="my-posts-and-reviews-container">

                    <% if(listings && listings.length) { %>
                        <div class="my-posts-container">
                            <div class="container">
                                <div class="row">
                                    <div class="col-12 mb-3 mb-lg-5">
                                        <div class="overflow-hidden card table-nowrap table-card">
                                            <div class="card-header d-flex justify-content-between align-items-center">
                                                <h5 class="mb-0">All Postings</h5>
                                            </div>
                                            <div class="table-responsive">
                                                <table class="table mb-0">
                                                    <thead class="small text-uppercase bg-body text-muted">
                                                        <tr>
                                                            <th>Title</th>
                                                            <th>Created Date</th>
                                                            <th class="text-end">Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <% for (let i = (listings.length-1); i >= 0;  i--) { %>
                                                        <tr class="align-middle">
                                                            <td>
                                                                <div class="d-flex align-items-center">
                                                                    <img src="<%= listings[i].image.url %>" class="avatar sm rounded-pill me-3 flex-shrink-0" alt="Customer">
                                                                    <div>
                                                                        <div class="h6 mb-0 lh-1"><%= listings[i].title %></div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td><%= listings[i].createdAt.toLocaleString('en-IN').slice(0,8) %></td>
                                                            <td class="text-end">
                                                                <div class="drodown">
                                                                    <a data-bs-toggle="dropdown" href="#" class="btn p-1" aria-expanded="false">
                                                              <i class="fa fa-bars" aria-hidden="true"></i>
                                                            </a>
                                                                    <div class="dropdown-menu dropdown-menu-end" >
                                                                        <a href="/listings/<%= listings[i]._id %>" class="dropdown-item">View Details</a>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <% } %>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                 


                        </div>
                     <% }%> 

                     <% if(reviews && reviews.length) { %>
                        <div class="my-reviews-container">
                            <div class="container" style="height:fit-content;">
                                <div class="row">
                                    <div class="col-12 mb-3 mb-lg-5">
                                        <div class="overflow-hidden card table-nowrap table-card">
                                            <div class="card-header d-flex justify-content-between align-items-center">
                                                <h5 class="mb-0">Your Reviews</h5>
                                            </div>
                                            <div class="table-responsive">
                                                <table class="table mb-0">
                                                    <thead class="small text-uppercase bg-body text-muted">
                                                        <tr>
                                                            <th>Title</th>
                                                            <th>Created Date</th>
                                                            <th class="text-end">Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <% for (let i = (reviews.length-1); i >= 0;  i--) { %>
                                                        <tr class="align-middle">
                                                            <td>
                                                                <div class="d-flex align-items-center">
                                                                    <img src="<%= reviews[i].listing.image.url %>" class="avatar sm rounded-pill me-3 flex-shrink-0" alt="Customer">
                                                                    <div>
                                                                        <div class="h6 mb-0 lh-1"><%= reviews[i].comment %></div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td><%= reviews[i].createdAt.toLocaleString('en-IN').slice(0,8) %></td>
                                                            <td class="text-end">
                                                                <div class="drodown">
                                                                    <a data-bs-toggle="dropdown" href="#" class="btn p-1" aria-expanded="false">
                                                              <i class="fa fa-bars" aria-hidden="true"></i>
                                                            </a>
                                                                    <div class="dropdown-menu dropdown-menu-end" >
                                                                        <a href="/listings/<%= reviews[i].listing._id %>" class="dropdown-item">View Details</a>                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <% } %>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <% } %>
                </div>
            </div>


            <%- include('./includes/footer.ejs') %>
    </body>

    </html>